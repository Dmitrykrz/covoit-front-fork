<div class="change-container">
  <!-- Header avec logo et titre -->
  <header class="change-header">
    <div class="logo-container">
      <img src="images/covoit-logo.png" alt="Covoit" class="logo">
    </div>
    <div class="header-text">
      <h1>MODIFICATION DU MOT DE PASSE</h1>
      <h2>SÉCURISEZ VOTRE COMPTE</h2>
    </div>
    <div class="logo-container">
      <img src="images/covoit-logo.png" alt="Covoit" class="logo">
    </div>
  </header>

  <!-- Formulaire de changement -->
  <div class="change-form-container">
    <div class="change-card">
      <h3>CHANGER VOTRE MOT DE PASSE</h3>

      @if (messageSucces) {
        <div class="success-message-container">
          <i class="fas fa-check-circle"></i>
          {{ messageSucces }}
        </div>
      }

      @if (messageErreur) {
        <div class="error-message-container">
          <i class="fas fa-exclamation-circle"></i>
          {{ messageErreur }}
        </div>
      }

      @if (!messageSucces) {
        <p class="instruction-text">
          Entrez votre nouveau mot de passe. Assurez-vous qu'il contient au moins 6 caractères.
        </p>

        <form [formGroup]="formulaireMotDePasse" (ngSubmit)="soumettre()" class="change-form">
          <!-- Champ nouveau mot de passe -->
          <div class="form-group">
            <div class="password-container">
              <input
                [type]="afficherMotDePasse ? 'text' : 'password'"
                id="nouveauMotDePasse"
                formControlName="nouveauMotDePasse"
                placeholder="Nouveau mot de passe"
                class="form-input password-input"
                [class.error]="nouveauMotDePasse?.invalid && nouveauMotDePasse?.touched"
                [disabled]="chargement">
              <button
                type="button"
                class="password-toggle"
                (click)="basculerVisibiliteMotDePasse()"
                aria-label="Afficher/masquer le mot de passe">
                <i class="fas" [class.fa-eye]="!afficherMotDePasse" [class.fa-eye-slash]="afficherMotDePasse"></i>
              </button>
            </div>
            @if (nouveauMotDePasse?.invalid && nouveauMotDePasse?.touched) {
              <div class="error-message">
                @if (nouveauMotDePasse?.errors?.['required']) {
                  <span>Le nouveau mot de passe est requis</span>
                }
                @if (nouveauMotDePasse?.errors?.['minlength']) {
                  <span>Le mot de passe doit contenir au moins 6 caractères</span>
                }
              </div>
            }
          </div>

          <!-- Champ confirmation mot de passe -->
          <div class="form-group">
            <div class="password-container">
              <input
                [type]="afficherConfirmation ? 'text' : 'password'"
                id="confirmationMotDePasse"
                formControlName="confirmationMotDePasse"
                placeholder="Confirmer le mot de passe"
                class="form-input password-input"
                [class.error]="(confirmationMotDePasse?.invalid && confirmationMotDePasse?.touched) || motsDePasseDifferents"
                [disabled]="chargement">
              <button
                type="button"
                class="password-toggle"
                (click)="basculerVisibiliteConfirmation()"
                aria-label="Afficher/masquer la confirmation">
                <i class="fas" [class.fa-eye]="!afficherConfirmation" [class.fa-eye-slash]="afficherConfirmation"></i>
              </button>
            </div>
            @if (confirmationMotDePasse?.invalid && confirmationMotDePasse?.touched) {
              <div class="error-message">
                @if (confirmationMotDePasse?.errors?.['required']) {
                  <span>La confirmation du mot de passe est requise</span>
                }
              </div>
            }
            @if (motsDePasseDifferents) {
              <div class="error-message">
                <span>Les mots de passe ne correspondent pas</span>
              </div>
            }
          </div>

          <!-- Boutons d'action -->
          <div class="button-group">
            <button
              type="button"
              class="cancel-btn"
              (click)="annuler()"
              [disabled]="chargement">
              ANNULER
            </button>
            <button
              type="submit"
              class="submit-btn"
              [disabled]="formulaireMotDePasse.invalid || chargement">
              @if (chargement) {
                <i class="fas fa-spinner fa-spin"></i> Modification...
              } @else {
                MODIFIER
              }
            </button>
          </div>
        </form>
      }
    </div>
  </div>
</div>