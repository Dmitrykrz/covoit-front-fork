<div class="page-wrapper">
  <app-navbar></app-navbar>

  <main class="mes-reservations-container">
    <h1 class="page-title">MES R√âSERVATIONS</h1>

    <!-- Message d'erreur -->
    <div *ngIf="errorMessage" class="error-message">
      {{ errorMessage }}
    </div>

    <!-- Loader -->
    <div *ngIf="isLoading" class="loading-spinner">
      <div class="spinner"></div>
      <p>Chargement des r√©servations...</p>
    </div>

    <!-- Tableau des r√©servations -->
    <div *ngIf="!isLoading && reservations && reservations.length > 0" class="reservations-table-container">
      <table class="reservations-table">
        <thead>
        <tr>
          <th>Conducteur</th>
          <th>V√©hicule</th>
          <th>Adresse de d√©part</th>
          <th>Adresse d'arriv√©e</th>
          <th>Date de d√©part</th>
          <th>Dur√©e du trajet</th>
          <th>Distance du trajet</th>
          <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let reservation of reservations">
          <td>{{ getConducteurLabel(reservation) }}</td>
          <td>{{ getVehiculeLabel(reservation) }}</td>
          <td>{{ formatAdresse(reservation.annonce.adresseDepart) }}</td>
          <td>{{ formatAdresse(reservation.annonce.adresseArrivee) }}</td>
          <td>{{ formatDateDepart(reservation.annonce.heureDepart) }}</td>
          <td>{{ formatDuree(reservation.annonce.dureeTrajet) }}</td>
          <td>{{ formatDistance(reservation.annonce.distance) }}</td>
          <td class="actions-cell">
            <button
              class="action-btn info-btn"
              (click)="voirDetails(reservation)"
              title="Voir les d√©tails">
              <i class="icon-info">‚ÑπÔ∏è</i>
            </button>
            <button
              class="action-btn delete-btn"
              (click)="confirmerAnnulation(reservation)"
              title="Annuler la r√©servation">
              <i class="icon-delete">üóëÔ∏è</i>
            </button>
          </td>
        </tr>
        </tbody>
      </table>
    </div>

    <!-- Message si aucune r√©servation -->
    <div *ngIf="!isLoading && (!reservations || reservations.length === 0)" class="no-reservations">
      <p>Vous n'avez pas encore r√©serv√© de covoiturage.</p>
    </div>

    <!-- Bouton rechercher un covoiturage -->
    <div class="action-button-container">
      <button class="btn-rechercher-covoiturage" (click)="rechercherCovoiturage()">
        RECHERCHER UN COVOITURAGE
      </button>
    </div>
  </main>

  <app-footer></app-footer>
</div>

<!-- Modal de confirmation d'annulation (en dehors du wrapper) -->
<app-delete-confirmation-dialog
  [open]="showDeleteModal"
  [title]="'Confirmer l\'annulation'"
  [message]="'√ätes-vous s√ªr de vouloir annuler cette r√©servation ?'"
  [warningMessage]="''"
  [confirmLabel]="'Confirmer'"
  [cancelLabel]="'Annuler'"
  (confirm)="annulerReservation()"
  (cancel)="annulerConfirmation()">
</app-delete-confirmation-dialog>

<!-- Modal de d√©tails de la r√©servation -->
<app-reservation-detail-modal
  *ngIf="showDetailModal"
  [reservation]="selectedReservation"
  [conducteur]="selectedReservation?.conducteur"
  [isOpen]="showDetailModal"
  (close)="showDetailModal = false"
  (annuler)="confirmerAnnulation(selectedReservation!)">
</app-reservation-detail-modal>
