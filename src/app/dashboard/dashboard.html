<div class="dashboard-container">
  <!-- Header/Navbar -->
  <header class="dashboard-header">
    <div class="header-left">
      <div class="logo-container">
        <img src="images/covoit-logo.png" alt="Covoit" class="logo">
      </div>
      <nav class="main-nav">
        <button
          class="nav-btn"
          [class.active]="activeTab === 'accueil'"
          (click)="setActiveTab('accueil')">
          Accueil
        </button>
        <button
          class="nav-btn"
          [class.active]="activeTab === 'reservations'"
          (click)="setActiveTab('reservations')">
          Réservations
        </button>
        <button
          class="nav-btn"
          [class.active]="activeTab === 'annonces'"
          (click)="setActiveTab('annonces')">
          Annonces
        </button>
        <button
          class="nav-btn"
          [class.active]="activeTab === 'vehicules'"
          (click)="setActiveTab('vehicules')">
          Véhicules
        </button>
      </nav>
    </div>

    <div class="header-right">
      <div class="user-info" [routerLink]="['/profil']" style="cursor: pointer;">
        <span class="user-name">{{ getUserDisplayName() }}</span>
        <div class="user-avatar">
          <i class="fas fa-user"></i>
        </div>
      </div>

      <button class="logout-btn" (click)="logout()">
        <i class="fas fa-sign-out-alt"></i>
      </button>
    </div>
  </header>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner">
      <i class="fas fa-spinner fa-spin"></i>
      <p>Chargement de vos données...</p>
    </div>
  </div>

  <!-- Error State -->
  <div *ngIf="hasError && !isLoading" class="error-container">
    <div class="error-message">
      <i class="fas fa-exclamation-triangle"></i>
      <h3>Erreur de chargement</h3>
      <p>{{ errorMessage }}</p>
      <button class="retry-btn" (click)="refreshData()">Réessayer</button>
    </div>
  </div>

  <!-- Main Content -->
  <main class="dashboard-main" *ngIf="!isLoading && !hasError">

    <!-- Section principale avec cartes conditionnelles -->
    <section class="dashboard-section">
      <div class="section-grid">

        <!-- Card Réservation Covoiturage -->
        <div class="action-card">
          <div class="card-header">
            <h3>Ma prochaine réservation</h3>
          </div>
          <div class="card-content">

            <!-- Version sans données -->
            <div *ngIf="!hasReservationCovoiturage">
              <p class="no-data">Vous n'avez pas encore réservé de covoiturage</p>
              <button class="card-action-btn" (click)="rechercherCovoiturage()">
                RECHERCHER UN COVOITURAGE
              </button>
            </div>

            <!-- Version avec données -->
            <div *ngIf="hasReservationCovoiturage">
              <div class="reservation-info">
                <div class="date-time">
                  <i class="fas fa-calendar"></i>
                  <span>{{ reservationCovoiturageInfo?.dateHeure }}</span>
                </div>
                <div class="route">
                  <span>{{ reservationCovoiturageInfo?.route }}</span>
                </div>
                <div class="trip-details">
                  <span>{{ reservationCovoiturageInfo?.dureeTrajet }} - {{ reservationCovoiturageInfo?.distance }}</span>
                </div>
              </div>
              <button class="card-action-btn" (click)="rechercherCovoiturage()">
                RECHERCHER UN AUTRE COVOITURAGE
              </button>
            </div>
          </div>
        </div>

        <!-- Card Annonce -->
        <div class="action-card">
          <div class="card-header">
            <h3>Ma prochaine Annonce</h3>
          </div>
          <div class="card-content">

            <!-- Version sans données -->
            <div *ngIf="!hasAnnonce">
              <p class="no-data">Vous n'avez pas encore fait d'annonces</p>
              <button class="card-action-btn" (click)="posterAnnonce()">
                POSTER UNE ANNONCE
              </button>
            </div>

            <!-- Version avec données -->
            <div *ngIf="hasAnnonce">
              <div class="annonce-info">
                <div class="date-time">
                  <i class="fas fa-calendar"></i>
                  <span>{{ annonceInfo?.dateHeure }}</span>
                </div>
                <div class="route">
                  <span>{{ annonceInfo?.route }}</span>
                </div>
                <div class="car-info">
                  <i class="fas fa-car"></i>
                  <span>{{ annonceInfo?.vehicule }}</span>
                </div>
                <div class="places-info">
                  <span>Places libres: {{ annonceInfo?.places }}</span>
                </div>
              </div>
              <button class="card-action-btn" (click)="posterAnnonce()">
                POSTER UNE AUTRE ANNONCE
              </button>
            </div>
          </div>
        </div>

      <!-- Card Véhicule -->
      <div class="action-card">
        <div class="card-header">
          <h3>Ma réservation de véhicule</h3>
        </div>
        <div class="card-content">

          <!-- Version sans données -->
          <div *ngIf="!hasReservationVehicule">
            <p class="no-data">Vous n'avez pas encore réservé de véhicule de société</p>
            <button class="card-action-btn" (click)="reserverVehicule()">
              RÉSERVER UN VÉHICULE DE SOCIÉTÉ
            </button>
          </div>

          <!-- Version avec données -->
          <div *ngIf="hasReservationVehicule">
            <div class="vehicle-info">
              <div class="vehicle-details">
                <span class="vehicle-name">{{ reservationVehiculeInfo?.vehicule }}</span>
                <span class="vehicle-plate">{{ reservationVehiculeInfo?.immatriculation }}</span>
                <span class="reservation-period">{{ reservationVehiculeInfo?.periode }}</span>
                <span
                  *ngIf="reservationVehiculeInfo?.afficherJoursRestants"
                  class="days-remaining"
                  [style.color]="'red'">{{ reservationVehiculeInfo?.joursRestants }}j restant(s)
                  </span>
              </div>
            </div>
            <button class="card-action-btn" (click)="reserverVehicule()">
              RÉSERVER UN AUTRE VÉHICULE DE SOCIÉTÉ
            </button>
          </div>
        </div>
      </div>

</div>
</section>

</main>

<!-- Footer -->
<footer class="dashboard-footer">
  <div class="footer-content">
    <div class="footer-logo">
      <span>Site réalisé par Goégiles</span>
      <img src="images/covoit-logo.png" alt="Goégiles">
    </div>
    <span>Copyright - Tous droits réservés</span>
  </div>
</footer>

</div>
